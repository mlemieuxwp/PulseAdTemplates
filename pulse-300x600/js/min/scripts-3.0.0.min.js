var xmlHttp=function(){function t(){for(var t=!1,n=0;n<e.length;n++){try{t=e[n]()}catch(r){continue}break}return t}function n(n,e){var r=t();r&&(r.open("GET",n,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||304==r.status)&&e(r)},r.send())}var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return{get:n}}();
var Utils=function(){function e(e,t,n){e.onclick=function(e){if(t){var r=document.createElement("img");r.alt="",r.border=0,r.src=t,r.style.width="1px",r.style.height="1px",r.style.display="none",n.appendChild(r)}}}function t(){return"ontouchstart"in window||navigator.maxTouchPoints}function n(){var e=document.getElementById("articles");if(e.querySelectorAll){var t=e.querySelectorAll(".pulse-article-number");for(i=0;i<t.length;i++)t[i].innerText=i+1}}function r(e){if(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}}return{clickTrackHandler:e,setArticleNum:n,shuffleArray:r,isTouchDevice:t}}();
var Templates=function(){function e(e,i){for(var s,r=/<%([^%>]+)?%>/g,t=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,l="var r=[];\n",a=0,c=function(e,i){return l+=i?e.match(t)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",c};s=r.exec(e);)c(e.slice(a,s.index))(s[1],!0),a=s.index+s[0].length;return c(e.substr(a,e.length-a)),l+='return r.join("");',new Function(l.replace(/[\r\t\n]/g,"")).apply(i)}var i={articles:'<%if(this.showArticles) {%><%for(var index in this.articles) {%><li class="pulse-article-list-item"><div class="pulse-article-wrapper cf"><div class="pulse-article-thumb-wrapper"><a href="<%this.articles[index].url%><%this.urlParam%>" class="pulse-article-link" target="<% this.linkTarget(index) %>"><%if(this.articles[index].src) {%><img src="https://img.washingtonpost.com/wp-apps/imrs.php?src=<%this.articles[index].src%>&h=61&w=61" border="0" class="pulse-article-thumbnail" /><%}%></a></div><div class="pulse-article-number"></div><div class="pulse-article-desc-wrapper"><p class="pulse-article-desc"><a href="<%this.articles[index].url%><%this.urlParam%>" class="pulse-article-link pulse-article-desc-link" target="<% this.linkTarget(index) %>"><%this.articles[index].title%></a></p></div></div></li><%}%><%} else {%><p>none</p><%}%>'};return{engine:e,types:i}}();
var PulseArticles=function(){function t(t){function e(e){e=JSON.parse(e),l=u?Utils.shuffleArray(e).slice(0,n):e.slice(0,n);var r=Templates.engine(Templates.types.articles,{articles:l,showArticles:!0,sponsorAll:o,linkTarget:function(t){return o||this.articles[t].sponsor?"_blank":"_top"},urlParam:g?"?spon_con="+g:""});if(t.innerHTML=r,t.querySelectorAll){var a=t.querySelectorAll("a");for(i=0;i<a.length;i++)Utils.clickTrackHandler(a[i],s,c)}Utils.setArticleNum()}if(t){var l,r=t.getAttribute("data-articles"),a=t.getAttribute("data-feed"),s=t.getAttribute("data-clicktrack"),n=t.getAttribute("data-maxlength")||3,c=document.getElementsByClassName("pulse-tracking-wrapper")[0],u=t.getAttribute("data-shuffle"),o=t.getAttribute("data-sponsorall")||!1,g=t.getAttribute("data-urlparam");a?xmlHttp.get(a,function(t){e(t.responseText)}):r&&e(r)}}function e(){for(var e=document.getElementById("articles"),l=document.getElementsByClassName("pulse-article-list"),r=l.length;r--;)t(l[r]);e.style.display="block"}return{init:e}}();PulseArticles.init();
var PulsePlayer=function(){function e(){window.open(d)}function t(e,t){e.muted?(e.muted=!1,t.classList.remove("pulse-player-muted")):(e.muted=!0,t.classList.add("pulse-player-muted"))}function n(n,r,a){var i="click";Utils.isTouchDevice()&&(i="touchstart"),r.length&&!n.hasAttribute("autoplay")?(r.addEventListener(i,function(){return a.click(),!1}),r.on(i,function(e){$video_play_button.click()})):n.addEventListener(i,function(){return e(),!1}),n.hasAttribute("autoplay")&&(n.setAttribute("playing","true"),n.parentNode.classList.add("pulse-player-active"),t(n,r))}function r(e,t,n){o&&(e.load(),t.removeEventListener("click",function(){n.click()}),o=!1),e.paused||e.ended?(e.play(),e.setAttribute("playing","true"),e.parentNode.classList.add("pulse-player-active")):(e.pause(),e.removeAttribute("playing"),e.parentNode.classList.remove("pulse-player-active"))}function a(e){!e.getAttribute("poster")&&e.getAttribute("data-current-time")&&(e.currentTime=e.getAttribute("data-current-time"))}function i(e,t){!e.getAttribute("poster")&&e.getAttribute("data-current-time")&&(e.currentTime=e.getAttribute("data-current-time")),p&&e.parentNode.classList.remove("pulse-player-active")}function u(){Array.prototype.forEach.call(c,function(e){var u=e.getElementsByTagName("video")[0],l=e.querySelector(".pulse-player-play-toggle"),s=e.querySelector(".pulse-player-volume-toggle");l.addEventListener("click",function(){r(u,e,this)}),s.addEventListener("click",function(){t(u,e,this)}),n(u,e,l),a(u),u.addEventListener("ended",function(){i(u,e)})})}function l(){u()}var s=document.getElementsByClassName("pulse-wrapper")[0],c=document.getElementsByClassName("pulse-player-wrapper"),o=!0,d=s.getAttribute("data-click"),p=document.getElementsByClassName("pulse-player-no-ctrls").length>0?!1:!0;return{init:l}}();document.addEventListener("DOMContentLoaded",PulsePlayer.init(),!1);
var PulseTracking=function(){function e(e){var t=new Image;t.alt="",t.border=0,t.height=1,t.width=1,t.style.display="none",e&&(e=e.replace(/%%CACHEBUSTER%%/gi,""),e+=Math.floor(1e12*Math.random())+"?",t.src=e,d.appendChild(t))}function t(e){var t=(e/4).toFixed(1);sessionStorage.setItem("one",t),sessionStorage.setItem("two",(2*t).toFixed(1)),sessionStorage.setItem("three",(3*t).toFixed(1))}function n(){var t=i.currentTime.toFixed(1);m&&t>=parseInt(sessionStorage.getItem("one"))?(e(m),sessionStorage.setItem("one",null)):p&&t>=parseInt(sessionStorage.getItem("two"))?(e(p),sessionStorage.setItem("two",null)):I&&t>=parseInt(sessionStorage.getItem("three"))&&(e(I),sessionStorage.setItem("three",null))}function s(){e(g)}function a(){e(c),t(this.duration)}function r(){i&&(i.addEventListener("ended",s,!1),i.addEventListener("timeupdate",n,!1),i.addEventListener("play",a,!1))}function o(){r()}var i=document.getElementById("pulse-player"),l=document.getElementsByClassName("pulse-player-wrapper")[0],d=document.getElementsByClassName("pulse-tracking-wrapper")[0],u=l&&l.getAttribute("data-videotracking");if(u=u&&JSON.parse(u),"undefined"!=typeof u&&u)var c=u.trackstart||null,g=u.track100||null,m=u.track25||null,p=u.track50||null,I=u.track75||null;return{init:o}}();document.addEventListener("DOMContentLoaded",PulseTracking.init(),!1);