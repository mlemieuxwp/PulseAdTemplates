!function(t){"use strict";function n(t,n){var e;for(e in t)a(t[e],n,e==t.length-1)}function e(t,n,e){var o=t.onload;t.onload=function(){o(),n&&e&&n()}}function o(t,n,o){var a=d[t];a?e(a,n,o):r(t,n,o)}function a(t,e,a){var i=s.shim[t];i&&i.deps.length?n(i.deps,function(){r(t,e,a)}):o(t,e,a)}function r(t,n,e){function o(o){delete d[t],r.onload=r.onreadystatechange=r.onerror="",n&&e&&n()}function a(n){throw new Error("Syntax or http error: "+t)}var r=document.createElement("script");return r.type="text/javascript",r.onload=r.onreadystatechange=o,r.onerror=a,r.charset="utf-8",d[t]=r,r.src=s.path[t]?s.path[t]:t,c.appendChild(r),r}var s={path:{jquery:"https://www.washingtonpost.com/wp-stat/advertising/PostPulse/js/jquery-1.11.0.min.js",slick:"https://www.washingtonpost.com/wp-stat/advertising/PostPulse/js/mobile-300x250/slick.min.js"},shim:{slick:{deps:["jquery"]}}},i=t.document,c=i&&(i.head||i.getElementsByTagName("head")[0]),d={};t.getScript=n}(this.window||"undefined"!=typeof global&&global||this);
var xmlHttp=function(){function t(){for(var t=!1,n=0;n<e.length;n++){try{t=e[n]()}catch(r){continue}break}return t}function n(n,e){var r=t();r&&(r.open("GET",n,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status||304==r.status)&&e(r)},r.send())}var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return{get:n}}();
var Utils=function(){function t(t){return t&&!/.gif/i.test(t)&&(t="https://img.washingtonpost.com/wp-apps/imrs.php?src="+t+"&h=250&w=300"),t}function e(t){t.onclick=function(t){if(linkClickPixel){var e=document.createElement("img");e.alt="",e.border=0,e.src=linkClickPixel,e.style.width="1px",e.style.height="1px",e.style.display="none",pulseTrackingWrapper.appendChild(e)}}}function r(t){if(!t){var e=document.getElementsByClassName("pulse-mobile-wrapper")[0];t=e.getAttribute("data-click")}return t}function i(t){for(var e=t.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[r],t[r]=i}return t}return{checkImgSrc:t,clickTrackHandler:e,setAdClick:r,shuffleArray:i}}();
var Templates=function(){function e(e,i){for(var s,a=/<%([^%>]+)?%>/g,r=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,t="var r=[];\n",l=0,c=function(e,i){return t+=i?e.match(r)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",c};s=a.exec(e);)c(e.slice(l,s.index))(s[1],!0),l=s.index+s[0].length;return c(e.substr(l,e.length-l)),t+='return r.join("");',new Function(t.replace(/[\r\t\n]/g,"")).apply(i)}var i={articles:'<%if(this.showArticles) {%><%for(var index in this.articles) {%><div class="js-pulse-mobile-article <%if(this.sponsorAll || this.articles[index].sponsor) {%>slick-sponsor<%}%>"><div class="pulse-mobile-desc-wrapper"><div class="pulse-mobile-desc"><a href="<%this.articles[index].url%><%this.url_param%>" class="pulse-mobile-desc-link" target="<% this.linkTarget(index) %>"><p class="pulse-mobile-desc-text"><%this.articles[index].title%></p><p class="pulse-mobile-article-readmore">READ MORE <i class="fa fa-angle-double-right fa-1"></i></p></a></div><span class="pulse-mobile-logo"></span></div><img class="pulse-mobile-slide-img" data-lazy="https://img.washingtonpost.com/wp-apps/imrs.php?src=<%this.articles[index].src%>&w=300"></div><%}%><%} else {%><p>none</p><%}%>',html:'<div data-animate="true"><%this.ad.html%></div>',iframe:'<div data-animate="true"><iframe src="<%this.ad.src%>?clickTag=<% this.setAdClick(this.ad.url) %>" border="0" frameBorder="0" height="250" scrolling="no" width="300" style="border:0"></iframe></div>',image:'<div data-animate="true"><a href="<% this.setAdClick(this.ad.url) %>" target="_blank"><%if(this.ad.src) {%><img src="<% this.checkImgSrc(this.ad.src) %>" alt="" border="0" style="border:0" /><%}%></a></div>',video:'<div data-animate="true"><div class="pulse-player-wrapper" data-videotracking=\'<% this.ad.videoTracking %>\'><i class="fa fa-4x fa-play-circle-o pulse-player-play"></i><i class="fa fa-volume-up pulse-player-volume"></i><video id="pulse-player" class="pulse-player" data-current-time="0.25" poster="<% this.ad.poster_url %>"><%if(this.ad.src) {%><source src="<%this.ad.src%>" type="video/mp4" /><%}%></video></div></div>'};return{engine:e,types:i}}();
var PulseSlides=function(){function e(e){function t(t){t=JSON.parse(t),c?r=Utils.shuffleArray(t).slice(0,3):(r=t.slice(0,3),r.reverse());var a=Templates.engine(Templates.types.articles,{articles:r,linkTarget:function(e){return this.articles[e].sponsor?"_blank":"_top"},showArticles:!0,sponsorAll:n,urlParam:s?"?spon_con="+s:""}),l=e.getAttribute("data-ad");if(l=JSON.parse(l),l&&"video"===l.type&&(l.videoTracking={},l.videoTracking.trackStart=l.trackstart||null,l.videoTracking.track25=l.track25||null,l.videoTracking.track50=l.track50||null,l.videoTracking.track75=l.track75||null,l.videoTracking.track100=l.track100||null,l.videoTracking=JSON.stringify(l.videoTracking)),l){var o=Templates.engine(Templates.types[l.type],{ad:l,setAdClick:Utils.setAdClick,checkImgSrc:Utils.checkImgSrc});a=o+a}var d=document.createElement("div");for(d.innerHTML=a,i=0;i<d.childNodes.length;)el=d.childNodes[i],d.removeChild(el),e.insertBefore(el,e.firstChild);if(e.querySelectorAll){var u=e.querySelectorAll("a");for(i=0;i<u.length;i++)Utils.clickTrackHandler(u[i])}}if(e){var r,a=e.getAttribute("data-articles"),l=e.getAttribute("data-feed"),c=(e.getAttribute("data-clicktrack"),document.getElementsByClassName("pulse-tracking-wrapper")[0],e.getAttribute("data-shuffle")),n=e.getAttribute("data-sponsorall")||!1,s=e.getAttribute("data-urlparam");l?xmlHttp.get(l,function(e){t(e.responseText)}):a&&t(a)}}function t(){var t=document.getElementById("articles");e(t)}return{init:t}}();PulseSlides.init();
getScript(["jquery","slick"],function(){var e=$.proxy($.fn.find,$(document)),a=e(".pulse-mobile"),n=e(".pulse-mobile-wrapper").data("click"),i=function(){function i(e){e.preventDefault(),window.open(n)}function s(){var n=a.slick("getSlick");n.slideCount-1;a.on("beforeChange",function(a,n,i,s){n.$slides[s].classList.contains("slick-sponsor")&&!e(".pulse-mobile-wrapper").hasClass("pulse-sponsored")&&e(".pulse-mobile-wrapper").addClass("pulse-sponsored"),n.$slides[s].hasAttribute("data-animate")&&e(".js-pulse-animate").slideUp(),e(".js-pulse-animate").is(":visible")||e(".js-pulse-animate").slideDown()}),a.on("afterChange",function(a,n,i){!n.$slides[i].classList.contains("slick-sponsor")&&e(".pulse-mobile-wrapper").hasClass("pulse-sponsored")&&e(".pulse-mobile-wrapper").removeClass("pulse-sponsored")})}function t(){a.slick({lazyLoad:"ondemand",rtl:!1})}function l(a){var n=e(a).data("poster");n&&a.setAttribute("poster",n)}function o(a){var n=e(a).data("src"),i=document.createElement("source");i.setAttribute("src",n),a.appendChild(i)}function r(){if(document.getElementById("pulse-player")){var n=document.getElementById("pulse-player"),i=n.parentNode.parentNode,s=e(i).data("slick-index");a.on("beforeChange",function(a,i,t,r){r===s?(l(n),o(n)):n.hasAttribute("playing")&&(n.pause(),e(".pulse-player-active").removeClass("pulse-player-active"),e(".pulse-player-pause").show(),n.removeAttribute("playing"))})}}function p(){if(document.getElementById("pulse-mobile-ad")){var n=document.getElementById("pulse-mobile-ad"),i=n.parentNode.parentNode,s=e(i).data("slick-index");a.on("beforeChange",function(a,i,t,l){if(!e(n).hasClass("js-pulse-mobile-ad-active")&&l===s){var o=e(n).data("iframe");e(n).append('<iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0" height="250" width="300" src="'+o+'" topmargin="0" leftmargin="0" allowtransparency="1"></iframe>').addClass("js-pulse-mobile-ad-active")}})}}function d(){if(n&&document.getElementById("js-pulse-mobile-img-ad")){document.getElementById("pulse-mobile-ad"),e(".pulse-mobile-wrapper").data("click");e("#js-pulse-mobile-img-ad").on("click",i)}}function u(){var n=document.getElementById("pulse-mobile-ad-iframe");if(n){var i=e(n).data("slick-index"),s=e(n).children(":first")[0],t=e(s).is("NOSCRIPT")?!0:!1,l=!1;i&&t&&a.on("beforeChange",function(a,t,o,r){if(r===i&&!l){var p=e(s).text();e(n).append(p),l=!0}})}}function c(){t(),s(),r(),p(),d(),u()}return{init:c}}();i.init()});
getScript(["jquery"],function(){var e=function(){function e(e){e&&(e=e.replace(/%%CACHEBUSTER%%/gi,""),e+=Math.floor(1e12*Math.random())+"?",o(".pulse-tracking-wrapper").append('<img src="'+e+'" alt="" border="0" height="1" width="1" style="display:none;" />'))}function a(){!$(c).attr("poster")&&$(c).data("current-time")&&(c.currentTime=$(c).data("current-time"))}function t(e){e.preventDefault(),window.open(d)}function l(e){e.preventDefault(),c.muted?(c.muted=!1,o(this).addClass("fa-volume-up"),o(this).removeClass("fa-volume-off")):(c.muted=!0,o(this).addClass("fa-volume-off"),o(this).removeClass("fa-volume-up"))}function r(a){a.preventDefault(),h.length&&isFirstClick&&(h.off("click"),isFirstClick=!1,o(c).on("click",t)),c.paused||c.ended?(e(f),c.play(),c.setAttribute("playing","true"),o(c).parent().addClass("pulse-player-active"),o(c).css("visibility","visible"),o(this).addClass("fa-pause-circle-o pulse-player-pause")):(c.pause(),c.removeAttribute("playing"),o(this).removeClass("fa-pause-circle-o pulse-player-pause"))}function i(){e(m),c.load(),!$(c).attr("poster")&&$(c).data("current-time")&&(c.currentTime=$(c).data("current-time")),$has_video_ctrls&&(o(c).parent().removeClass("pulse-player-active"),v.removeClass("fa-pause-circle-o pulse-player-pause").show())}function p(){o(".pulse-mobile-wrapper").on("mouseenter",".pulse-player-active",function(){v.fadeIn()}),o(".pulse-mobile-wrapper").on("mouseleave",".pulse-player-active",function(){v.fadeOut()})}function s(){h.length&&!c.hasAttribute("autoplay")?h.on("click",function(e){v.click()}):o(c).on("click",t)}function n(){y.on("click",l),v.on("click",r),s(),a(),o(c).on("ended",i)}function u(){n(),p()}var o=$.proxy($.fn.find,$(document)),c=document.getElementById("pulse-player"),d=o(".pulse-mobile-wrapper").data("click"),f=o(".pulse-player-wrapper").data("video-track-play")||o(".pulse-mobile-wrapper").data("track")||!1,m=o(".pulse-player-wrapper").data("video-track-end")||!1,v=o(".pulse-player-play"),y=o(".pulse-player-volume"),h=o(".pulse-player-wrapper");return $has_video_ctrls=o(".pulse-player-no-ctrls").length>0?!1:!0,isFirstClick=!0,{init:u}}();e.init()});
var PulseTracking=function(){function e(e){var t=new Image;t.alt="",t.border=0,t.height=1,t.width=1,t.style.display="none",e&&(e=e.replace(/%%CACHEBUSTER%%/gi,""),e+=Math.floor(1e12*Math.random())+"?",t.src=e,d.appendChild(t))}function t(e){var t=(e/4).toFixed(1);sessionStorage.setItem("one",t),sessionStorage.setItem("two",(2*t).toFixed(1)),sessionStorage.setItem("three",(3*t).toFixed(1))}function n(){var t=i.currentTime.toFixed(1);m&&t>=parseInt(sessionStorage.getItem("one"))?(e(m),sessionStorage.setItem("one",null)):p&&t>=parseInt(sessionStorage.getItem("two"))?(e(p),sessionStorage.setItem("two",null)):I&&t>=parseInt(sessionStorage.getItem("three"))&&(e(I),sessionStorage.setItem("three",null))}function s(){e(g)}function a(){e(c),t(this.duration)}function r(){i&&(i.addEventListener("ended",s,!1),i.addEventListener("timeupdate",n,!1),i.addEventListener("play",a,!1))}function o(){r()}var i=document.getElementById("pulse-player"),l=document.getElementsByClassName("pulse-player-wrapper")[0],d=document.getElementsByClassName("pulse-tracking-wrapper")[0],u=l&&l.getAttribute("data-videotracking");if(u=u&&JSON.parse(u),"undefined"!=typeof u&&u)var c=u.trackStart||null,g=u.track100||null,m=u.track25||null,p=u.track50||null,I=u.track75||null;return{init:o}}();document.addEventListener("DOMContentLoaded",PulseTracking.init(),!1);